<head>
	<style>
		body {
			background-color: black;
			margin: 0;
		}

		video {
			width: 100%;
			height: 100%;
			background: none;
		}

		#label {
			color: white;
			text-transform: uppercase;
			font-family: monospace;
			text-align: center;
			align-content: center;
			position: fixed;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			z-index: -1;
		}
	</style>
</head>

<body>
	<div id="label">
		Click to Play
	</div>
	<script type="module">
		async function genElements(typeName, count) {
			const elems = [];
			for (var c = 0; c < count; c++) {
				var elem = document.createElement(typeName);
				switch (typeName) {
					case 'audio':
						var filePath = 'audio-' + String(c).padStart(3, '0') + '.mp3';
						break;
					case 'video':
						var filePath = 'video-' + String(c).padStart(3, '0') + '.mp4';
						elem.muted = true;
						break;
					default:
						return;
				}
				elem.src = filePath;
				elems.push(elem);
			}
			return [elems, count];
		}

		const [elemsVideo, VIDEO_TRACK_COUNT] = await genElements('video', 2);
		const [elemsAudio, AUDIO_TRACK_COUNT] = await genElements('audio', 13);

		async function play(elemTable, index) {
			for (var e of elemTable) e.pause();
			var elem = elemTable[index];
			document.body.appendChild(elem);
			await elem.play();
		}

		function playAudio(index) {
			return play(elemsAudio, index);
		}

		function playVideo(index) {
			return play(elemsVideo, index);
		}

		var indexAudio = Math.floor(Math.random() * AUDIO_TRACK_COUNT);
		function nextAudio() {
			playAudio(indexAudio).then(() => {
				indexAudio += 1;
				indexAudio %= AUDIO_TRACK_COUNT;
			});
		}

		var indexVideo = 0;
		function nextVideo() {
			playVideo(indexVideo).then(() => {
				indexVideo += 1;
				indexVideo %= VIDEO_TRACK_COUNT;
			});
		}

		for (var e of elemsAudio)
			e.addEventListener("ended", nextAudio);
		for (var e of elemsVideo)
			e.addEventListener("ended", nextVideo);

		var isStarted = false;
		async function startPlayback() {
			await playAudio(0);
			await playVideo(0);
			await document.body.requestFullscreen();
			if (isStarted)
				return;
			isStarted = true;
			document.body.removeEventListener("click", startPlayback);
		}

		document.body.addEventListener("click", startPlayback);
		//startPlayback();
	</script>
</body>